# 对方科目处理器使用说明

## 📥 安装要求
```bash
Python 3.8+ 环境
pip install -r requirements.txt
* 需Windows系统（因使用win32com操作Excel）
```

## 🖥️ 界面操作流程
1. ​**模式选择**  
   - 借贷分离模式：需指定借方/贷方金额列
   - 合并模式：需标识借贷方向列

2. ​**参数配置区**  
   | 参数项          | 输入示例     | 说明                      |
   |----------------|------------|--------------------------|
   | 凭证字号列       | B          | 凭证编号所在列（字母/数字） |
   | 目标列位置       | H          | 结果输出列（建议使用未使用的列） |

3. ​**文件处理流程**  
   ```mermaid
   graph TD
   A[选择文件/目录] --> B{批量模式?}
   B -->|是| C[遍历目录内所有Excel文件]
   B -->|否| D[处理单个文件]
   C/D --> E[自动移除筛选器]
   E --> F[识别对方科目]
   F --> G[生成带格式的新文件]
   ```

## ⚙️ 参数详解
### 借贷分离模式
| 参数           | 接受值类型       | 验证规则             |
|---------------|----------------|--------------------|
| 借方金额列      | 列字母/数字      | 必须包含数值数据      |
| 贷方金额列      | 列字母/数字      | 与借方列不能相同      |

### 合并模式
| 参数           | 特殊要求                     |
|---------------|----------------------------|
| 借贷标识列      | 必须包含用户定义的标识符（如"借"/"贷"） |
| 贷方处理方式    | 选择"取相反数"时自动转换数值符号     |

## 🚨 异常处理协议
**常见错误代码表**
| 错误现象                | 可能原因                  | 解决方案               |
|------------------------|-------------------------|----------------------|
| 列不存在               | 输入列标识错误             | 检查列字母是否超出文件范围 |
| 数值解析失败            | 金额列包含非数字字符        | 清理数据后重新处理      |
| 文件保存失败            | 目标文件正在被其他程序使用    | 关闭占用Excel进程      |

## 📊 性能优化建议
- 批量处理时：建议单个目录文件数 ≤ 50
- 内存优化：处理超过10MB文件时，建议关闭其他内存占用程序
- 格式保留：处理含复杂公式的文件时，处理时间增加约30%

## 🔍 调试模式
在代码入口添加调试参数：
```python
if __name__ == "__main__":
    root = tk.Tk()
    app = AdvancedAccountingProcessor(root)
    # 启用调试日志
    import logging
    logging.basicConfig(level=logging.DEBUG) 
    root.mainloop()
```

## 📁 文件命名规范
输出文件自动遵循以下命名规则：
```
原始文件名_处理后_YYYYMMDD_HHMMSS.xlsx
示例: 2023账套_处理后_20230815_143022.xlsx
```

## ⏱️ 处理耗时参考
| 文件大小   | 行数      | 预计耗时 |
|----------|----------|--------|
| 1-5MB    | 1k-5k行  | 15-30s |
| 5-10MB   | 5k-10k行 | 1-2min |
| 10MB+    | 10k行+   | >3min  |
